<section>
  <div class="container">
    <activity-header [item]="item"></activity-header>
  </div>

  <div class="container">
    
    <div class="row">
        <div class="col-md-6">
          <div class="input-group">
            <div class="custom-file">
              <label class="form-label" for="inputGroupFile">เลือกไฟล์นำเข้า</label>
              <input
                class="form-control"
                type="file"
                name="file"
                required
                (change)="handleImport($event)"
                accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
              />
            </div>
          </div>
        </div>

        <!-- <div class="row mb-2 mt-5">
          <div class="col-sm-6 offset-3">
            <div class="row"></div>
            <div class="col-md-6">
              <button (click)="handleExport()" class="btn btn-primary float-right">
                Export <i class="fa fa-download"></i>
              </button>
            </div>
          </div>
        </div> -->
    </div>

    <div class="row my-4">
        <div class="col d-flex justify-content-between align-items-center">
            <div class="">
        จำนวนรายการ <div class="badge bg-info">{{ students.length }}</div> รายการ
        เลือกนำเข้า <div class="badge bg-success">{{studentSelected}}</div> รายการ                
            </div>
            <div class="">
                <button class="btn btn-success btn-sm" [ngClass]="{'disabled':studentSelected<1}" (click)="onImport()">นำเข้ารายชื่อ</button>
                <button class="btn btn-danger btn-sm" (click)="onCancel()" >ยกเลิก</button>
            </div>

        </div>
    </div>
  </div>



  <div class="container">

    <div class="row">
      <div class="col">
        <table class="table">
          <thead>
            <tr>
              <th scope="col">ลำดับ</th>
              <th scope="col">รหัสนิสิต</th>
              <th scope="col">ชื่อ-สกุล</th>
              <th scope="col">คณะ</th>
              <th scope="col">เลือก</th>
              <!-- <th scope="col">Director</th>
                            <th scope="col">Rating</th> -->
            </tr>
          </thead>
          <tbody>
            <ng-container *ngIf="students.length; else elseBlock">
              <tr *ngFor="let student of students; let i = index">
                <th scope="row">{{ i + 1 }}</th>
                <td>{{ student.studentcode }}</td>
                <td>{{ student.studentname }}</td>
                <td>{{ student.faculty }}</td>
                <!-- <td>{{ student.Director }}</td>
                                <td><span class="badge bg-warning text-dark">{{ student.Rating }}</span></td> -->
                <td>
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" value="" [(ngModel)]="student.selected">
                        <!-- <label class="form-check-label" for="flexCheckChecked">
                          Checked checkbox
                        </label> -->
                    </div>
                </td>
              </tr>
            </ng-container>
            <ng-template #elseBlock>
              <tr>
                <td colspan="5" class="text-center">No students Found.</td>
              </tr>
            </ng-template>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>